function potent_omp(rho,theta,phi,points,k)

  use constants
  
  implicit none

  !.. Input
  integer :: points,k
  real(kind(1.d0)) :: phi(:),theta,rho(:)

  !.. Output
  real(kind(1.d0)) :: potent_omp(size(rho))

  !.. Local
  integer i
  real(kind(1.d0)) :: V(size(rho)),Vder(size(rho)),summa(size(rho))

  !potent_omp = 0.d0

  print *, 'okiinside', points, k
  summa = 0.d0
  V = 0.d0
  Vder = 0.d0
  ! do i = 1, k
  !    print *, 'okiinsideloop', points, k
  !    call twobody_potential(rho,theta,phi(i),V,Vder,points)
  !    summa=summa+V
  ! end do

  potent_omp=summa
  !return
end function potent_omp
